module.exports = app => {
    const router = require('express').Router()

    //通过mogoose引用模型
    const mongoose = require('mongoose')
    mongoose.model.Category = require('../../models/Category')
    mongoose.model.Article = require('../../models/Article')
    mongoose.model.Hero = require('../../models/Hero')
    mongoose.model.Item = require('../../models/Item')
    mongoose.model.Strategy = require('../../models/Strategy')
    let Category = mongoose.model.Category,
        Article = mongoose.model.Article,
        Hero = mongoose.model.Hero,
        Item = mongoose.model.Item,
        Strategy = mongoose.model.Strategy

    //导入新闻数据
    router.get('/news/init', async (req, res) => {
        //lean()表示取纯粹的JS对象或者数组
        const parent = await Category.findOne({
            name: '新闻分类'
        })
        const cats = await Category.find().where({ parent: parent }).lean()
        const newsTitles = [
            "嫦娥个性表情票选结果公布",
            "互动小任务第13期-嫦娥个性表情票选开启",
            "大神在线解答，金蝉超全攻略！",
            "2021创意互动周即将开启！源·梦新皮肤即将揭晓！",
            "狄某有话说 |镜：挂机但不止挂机 输也要争分夺秒",
            "嫦娥源·梦皮肤语音台词票选结果公布",
            "狄某有话说 | 人形“防御塔”姜子牙，只防下了队友的胜利",
            "孙尚香异界灵契新皮肤上线，快手三大主题活动精彩不断！",
            "孙尚香-异界灵契优化沟通【老亚瑟的答疑时间】",
            "嫦娥源·梦皮肤台词语音投票活动开启公告",
            "虎牙雷霆杯新玩法上线！看主播，KPL选手同台竞技",
            "斗鱼暖冬福利庆典，限时领取专属头像框",
            "狄某有话说 | 武则天：稳重才更符合女帝的姿态",
            "各路大神带你闯关峡谷",
            "后续皮肤优化计划公布【老亚瑟的答疑时间】",
            "嫦娥个性表情票选结果公布",
            "互动小任务第13期-嫦娥个性表情票选开启",
            "大神在线解答，金蝉超全攻略！",
            "2021创意互动周即将开启！源·梦新皮肤即将揭晓！",
            "狄某有话说 |镜：挂机但不止挂机 输也要争分夺秒",
            "嫦娥源·梦皮肤语音台词票选结果公布",
            "新英雄金蝉斗鱼独家攻略",
            "狄某有话说 | 人形“防御塔”姜子牙，只防下了队友的胜利",
            "孙尚香异界灵契新皮肤上线，快手三大主题活动精彩不断！",
            "孙尚香-异界灵契优化沟通【老亚瑟的答疑时间】",
            "11月27日体验服不停机更新公告",
            "11月26日登录异常恢复说明",
            "11月26日登录异常说明",
            "11月26日全服不停机更新公告",
            "11月25日心愿单系统维护说明",
            "11月25日全服不停机更新公告",
            "11月24日净化游戏环境声明及处罚公告",
            "11月24日外挂专项打击公告",
            "11月24日“演员”惩罚名单",
            "11月24日游戏内违规签名、攻略信息处罚公告",
            "11月24日挂车行为专项违规处罚公告",
            "11月23日体验服停机更新公告",
            "后续皮肤优化计划公布",
            "11月23日英雄平衡性调整丨铠、妲己增强，高渐离优化",
            "11月19日体验服停机更新公告"]
        const newsList = newsTitles.map(title => {
            const randomCats = cats.slice(0).sort((a, b) => Math.random() - 0.5)
            return {
                categories: randomCats.slice(0, 2),
                title: title
            }
        })
        await Article.deleteMany({})
        await Article.insertMany(newsList)
        res.send(newsList)

    })

    //导入英雄数据
    router.get('/heroes/init', async (req, res) => {
        const rawData = [{ "name": "热门", "heroes": [{ "name": "鲁班七号", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/112/112.jpg" }, { "name": "亚瑟", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/166/166.jpg" }, { "name": "安琪拉", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/142/142.jpg" }, { "name": "后羿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/169/169.jpg" }, { "name": "吕布", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/123/123.jpg" }, { "name": "妲己", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/109/109.jpg" }, { "name": "孙悟空", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/167/167.jpg" }, { "name": "马可波罗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/132/132.jpg" }, { "name": "虞姬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/174/174.jpg" }, { "name": "瑶", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/505/505.jpg" }] }, { "name": "战士", "heroes": [{ "name": "赵云", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/107/107.jpg" }, { "name": "墨子", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/108/108.jpg" }, { "name": "钟无艳", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/117/117.jpg" }, { "name": "吕布", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/123/123.jpg" }, { "name": "夏侯惇", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/126/126.jpg" }, { "name": "曹操", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/128/128.jpg" }, { "name": "典韦", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/129/129.jpg" }, { "name": "宫本武藏", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/130/130.jpg" }, { "name": "达摩", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/134/134.jpg" }, { "name": "老夫子", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/139/139.jpg" }, { "name": "关羽", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/140/140.jpg" }, { "name": "程咬金", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/144/144.jpg" }, { "name": "露娜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/146/146.jpg" }, { "name": "花木兰", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/154/154.jpg" }, { "name": "橘右京", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/163/163.jpg" }, { "name": "亚瑟", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/166/166.jpg" }, { "name": "孙悟空", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/167/167.jpg" }, { "name": "刘备", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/170/170.jpg" }, { "name": "杨戬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/178/178.jpg" }, { "name": "雅典娜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/183/183.jpg" }, { "name": "哪吒", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/180/180.jpg" }, { "name": "铠", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/193/193.jpg" }, { "name": "苏烈", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/194/194.jpg" }, { "name": "梦奇", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/198/198.jpg" }, { "name": "裴擒虎", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/502/502.jpg" }, { "name": "狂铁", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/503/503.jpg" }, { "name": "孙策", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/510/510.jpg" }, { "name": "李信", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/507/507.jpg" }, { "name": "盘古", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/529/529.jpg" }, { "name": "云中君", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/506/506.jpg" }, { "name": "曜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/522/522.jpg" }, { "name": "马超", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/518/518.jpg" }, { "name": "蒙恬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/527/527.jpg" }, { "name": "夏洛特", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/536/536.jpg" }, { "name": "司空震", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/537/537.jpg" }] }, { "name": "法师", "heroes": [{ "name": "小乔", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/106/106.jpg" }, { "name": "墨子", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/108/108.jpg" }, { "name": "妲己", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/109/109.jpg" }, { "name": "嬴政", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/110/110.jpg" }, { "name": "高渐离", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/115/115.jpg" }, { "name": "孙膑", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/118/118.jpg" }, { "name": "扁鹊", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/119/119.jpg" }, { "name": "芈月", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/121/121.jpg" }, { "name": "周瑜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/124/124.jpg" }, { "name": "甄姬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/127/127.jpg" }, { "name": "武则天", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/136/136.jpg" }, { "name": "貂蝉", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/141/141.jpg" }, { "name": "安琪拉", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/142/142.jpg" }, { "name": "露娜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/146/146.jpg" }, { "name": "姜子牙", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/148/148.jpg" }, { "name": "王昭君", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/152/152.jpg" }, { "name": "张良", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/156/156.jpg" }, { "name": "不知火舞", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/157/157.jpg" }, { "name": "钟馗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/175/175.jpg" }, { "name": "诸葛亮", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/190/190.jpg" }, { "name": "干将莫邪", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/182/182.jpg" }, { "name": "女娲", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/179/179.jpg" }, { "name": "杨玉环", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/176/176.jpg" }, { "name": "弈星", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/197/197.jpg" }, { "name": "米莱狄", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/504/504.jpg" }, { "name": "司马懿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/137/137.jpg" }, { "name": "沈梦溪", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/312/312.jpg" }, { "name": "上官婉儿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/513/513.jpg" }, { "name": "嫦娥", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/515/515.jpg" }, { "name": "西施", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/523/523.jpg" }, { "name": "司空震", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/537/537.jpg" }] }, { "name": "坦克", "heroes": [{ "name": "廉颇", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/105/105.jpg" }, { "name": "庄周", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/113/113.jpg" }, { "name": "刘禅", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/114/114.jpg" }, { "name": "钟无艳", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/117/117.jpg" }, { "name": "白起", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/120/120.jpg" }, { "name": "芈月", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/121/121.jpg" }, { "name": "吕布", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/123/123.jpg" }, { "name": "夏侯惇", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/126/126.jpg" }, { "name": "达摩", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/134/134.jpg" }, { "name": "项羽", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/135/135.jpg" }, { "name": "程咬金", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/144/144.jpg" }, { "name": "刘邦", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/149/149.jpg" }, { "name": "亚瑟", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/166/166.jpg" }, { "name": "牛魔", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/168/168.jpg" }, { "name": "张飞", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/171/171.jpg" }, { "name": "太乙真人", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/186/186.jpg" }, { "name": "东皇太一", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/187/187.jpg" }, { "name": "铠", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/193/193.jpg" }, { "name": "苏烈", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/194/194.jpg" }, { "name": "梦奇", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/198/198.jpg" }, { "name": "孙策", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/510/510.jpg" }, { "name": "盾山", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/509/509.jpg" }, { "name": "嫦娥", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/515/515.jpg" }, { "name": "猪八戒", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/511/511.jpg" }, { "name": "蒙恬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/527/527.jpg" }, { "name": "阿古朵", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/533/533.jpg" }] }, { "name": "刺客", "heroes": [{ "name": "赵云", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/107/107.jpg" }, { "name": "阿轲", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/116/116.jpg" }, { "name": "李白", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/131/131.jpg" }, { "name": "貂蝉", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/141/141.jpg" }, { "name": "韩信", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/150/150.jpg" }, { "name": "兰陵王", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/153/153.jpg" }, { "name": "花木兰", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/154/154.jpg" }, { "name": "不知火舞", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/157/157.jpg" }, { "name": "娜可露露", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/162/162.jpg" }, { "name": "橘右京", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/163/163.jpg" }, { "name": "孙悟空", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/167/167.jpg" }, { "name": "百里守约", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/196/196.jpg" }, { "name": "百里玄策", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/195/195.jpg" }, { "name": "裴擒虎", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/502/502.jpg" }, { "name": "元歌", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/125/125.jpg" }, { "name": "司马懿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/137/137.jpg" }, { "name": "上官婉儿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/513/513.jpg" }, { "name": "云中君", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/506/506.jpg" }, { "name": "马超", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/518/518.jpg" }, { "name": "镜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/531/531.jpg" }, { "name": "澜", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/528/528.jpg" }] }, { "name": "射手", "heroes": [{ "name": "孙尚香", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/111/111.jpg" }, { "name": "鲁班七号", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/112/112.jpg" }, { "name": "马可波罗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/132/132.jpg" }, { "name": "狄仁杰", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/133/133.jpg" }, { "name": "后羿", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/169/169.jpg" }, { "name": "李元芳", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/173/173.jpg" }, { "name": "虞姬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/174/174.jpg" }, { "name": "成吉思汗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/177/177.jpg" }, { "name": "黄忠", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/192/192.jpg" }, { "name": "百里守约", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/196/196.jpg" }, { "name": "公孙离", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/199/199.jpg" }, { "name": "伽罗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/508/508.jpg" }, { "name": "蒙犽", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/524/524.jpg" }] }, { "name": "辅助", "heroes": [{ "name": "庄周", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/113/113.jpg" }, { "name": "刘禅", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/114/114.jpg" }, { "name": "孙膑", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/118/118.jpg" }, { "name": "牛魔", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/168/168.jpg" }, { "name": "张飞", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/171/171.jpg" }, { "name": "钟馗", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/175/175.jpg" }, { "name": "蔡文姬", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/184/184.jpg" }, { "name": "太乙真人", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/186/186.jpg" }, { "name": "大乔", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/191/191.jpg" }, { "name": "东皇太一", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/187/187.jpg" }, { "name": "鬼谷子", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/189/189.jpg" }, { "name": "明世隐", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/501/501.jpg" }, { "name": "盾山", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/509/509.jpg" }, { "name": "瑶", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/505/505.jpg" }, { "name": "鲁班大师", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/525/525.jpg" }, { "name": "阿古朵", "avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/533/533.jpg" }] }]

        for (let cat of rawData) {
            if (cat.name === '热门') {
                continue
            }

            //找到当前分类在数据库中对应的数据
            const category = await Category.findOne({
                name: cat.name
            })
            //给cat里面的每个hero添加一个categories属性
            cat.heroes.map(hero => {
                hero.categories = [category]
            })

            await Hero.insertMany(cat.heroes)
        }
        res.send(await Hero.find())
    })

    router.get('/strategy/init', async (req, res) => {
        const data1 = [{ "title": "XYGvs武汉estarpro.大仙解说.大仙鼓励弟弟们！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=771727&e_code=pvpweb_m.statictypenew.type587", "img": "https://momentcon-1255653016.cos.ap-guangzhou.myqcloud.com/1861736602/20001/3DFDEEF11F173237D058B50F254B7CD6.png?imageView2/1/w/230/h/140", "play_volume": "170", "cate": "精品栏目" }, { "title": "细节满满！金蝉0基础教学", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769792&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211117/39ebfb744a276feee80954ac22fc6d60_1637080626.jpg", "play_volume": "34.0万", "cate": "精品栏目" }, { "title": "金蝉 - 轮回之印铭文出装", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769561&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/8d8e23ec00c47ff8d06ffa1f254c0a5c/0/?width=230&height=140", "play_volume": "8.4万", "cate": "精品栏目" }, { "title": "金蝉 - 轮回之印技能连招技巧", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769560&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/ef1bf3bb1a64a916eceeac5d61d0f0b4/0/?width=230&height=140", "play_volume": "9.8万", "cate": "精品栏目" }, { "title": "金蝉 - 轮回之印三技能介绍", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769558&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/6f080c9f494b3dbbb910d7b6343f261d/0/?width=230&height=140", "play_volume": "9.0万", "cate": "精品栏目" }, { "title": "金蝉 - 轮回之印二技能介绍", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769551&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/915babc3a6797833c1fd219b714b7bf0/0/?width=230&height=140", "play_volume": "9.1万", "cate": "精品栏目" }, { "title": "金蝉 - 轮回之印被动技能介绍", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769547&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/3c532b788595fa6f2d0e269ae71a5dcf/0/?width=230&height=140", "play_volume": "67.5万", "cate": "精品栏目" }, { "title": "【峡谷风向标】3分钟学会新英雄金蝉！最绝望的控制莫过于此", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769510&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211115/6548904c2e49665fb1270dd8e8346b02_1636968772.jpg", "play_volume": "2.0万", "cate": "精品栏目" }, { "title": "【英雄爆料】金蝉·玩法介绍片——欢迎收看「悟空八戒的相声专场」", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=769489&e_code=pvpweb_m.statictypenew.type0", "img": "http://shp.qpic.cn/cfwebcap/0/763620e40fcce044b68ed7dd253ed32b/0/?width=230&height=140", "play_volume": "560.9万", "cate": "精品栏目" }, { "title": "好儿郎，浑身是胆，勇闯敌营！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=767089&e_code=pvpweb_m.statictypenew.type587", "img": "https://momentcon-1255653016.cos.ap-guangzhou.myqcloud.com/2126928986/20001/7117AF63981F5930B26E8B67950F7DA2.png?imageView2/1/w/230/h/140", "play_volume": "210", "cate": "精品栏目" }, { "title": "天暴：巅峰赛偶遇职业，双人配合偷爆水晶", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=767014&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211104/fe7b6494c0b768e22b640dd9726ed050_1636016933.png", "play_volume": "269", "cate": "精品栏目" }, { "title": "重庆狼队vs武汉estar.峡谷中的擦肩而过和落荒而逃", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=766962&e_code=pvpweb_m.statictypenew.type587", "img": "https://momentcon-1255653016.cos.ap-guangzhou.myqcloud.com/1861736602/20001/41F6003564B7BEAC51C9CE6712AE0A1C.png?imageView2/1/w/230/h/140", "play_volume": "706", "cate": "精品栏目" }, { "title": "这个矅没本事还吱吱喳喳！我只好拿出实力让其闭嘴！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=766965&e_code=pvpweb_m.statictypenew.type587", "img": "https://momentcon-1255653016.cos.ap-guangzhou.myqcloud.com/2126928986/20001/82A05454577BF382EECBEAF9D3682EE7.png?imageView2/1/w/230/h/140", "play_volume": "1097", "cate": "精品栏目" }, { "title": "超燃击杀集锦，王者荣耀中的击杀视觉盛宴系列1！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=766610&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211102/30df7236648521ac0838c1249d556bd3_1635837074.jpg", "play_volume": "1905", "cate": "精品栏目" }, { "title": "拔刀吧！阿离新曲《一舞翩翩》", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=766236&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211031/49d34e7f97f689152203b98ca7068bf2_1635656840.jpg", "play_volume": "251", "cate": "精品栏目" }, { "title": "天暴：巅峰赛21鲨，这就是嗜血屠夫嘛", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=766092&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211030/c6f03c78c5de39d247d4f909e4e077cb_1635585544.png", "play_volume": "1784", "cate": "精品栏目" }, { "title": "王者周年庆限时点券换皮肤攻略", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765958&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211029/736cbf5dde8ba764a9d118c4c499dbe6_1635510457.jpg", "play_volume": "2392", "cate": "精品栏目" }, { "title": "韩信击杀秀-话说那个蔡文姬从哪儿冒出来的，怎么双杀了？", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765124&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211025/51e512a9f3bd2239e956aaa419b0a4b3_1635137719.jpg", "play_volume": "160", "cate": "精品栏目" }, { "title": "巅峰赛上帝视角复盘，逆风，到底输在哪里？（上）", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765534&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211027/71e208a33fae64c56e2cfb8bf87f4e98_1635335984.jpg", "play_volume": "988", "cate": "精品栏目" }, { "title": "【王者六周年/超燃踩点混剪】燃情开场，见证荣耀！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765498&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211027/b3699df6f02c19ffc2fa22b6ca2e853b_1635325177.png", "play_volume": "1703", "cate": "精品栏目" }, { "title": "云中玉城的新英雄即将登场，他是那个囚徒，他是名字叫晟的英雄吗", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765227&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211025/79b0cc643d2934200fdc821561ac8df2_1635175844.jpg", "play_volume": "368", "cate": "精品栏目" }, { "title": "天暴：不信我是国服夫子，那我只好打到你服", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=765163&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211025/b4ce9c2689631f83d4afb6b001237e4b_1635152853.png", "play_volume": "918", "cate": "精品栏目" }, { "title": "天暴：夫子哥对抗细节，秀到船夫头皮发麻", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=764538&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211022/7793b1803f7db121a44f90c93a77d793_1634892501.png", "play_volume": "293", "cate": "精品栏目" }, { "title": "【COS偶像】第 215期：这就是“二次元”安琪拉吗！", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=764513&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211022/77859029ecfe521fa2e09c6f82b6dc0e_1634882134.jpg", "play_volume": "1154", "cate": "精品栏目" }, { "title": "国一狂铁VS国一李信！拿捏哥的退网之战", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=763964&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211019/cd1b3f509a27e05bbd224301c32450c3_1634628807.png", "play_volume": "704", "cate": "精品栏目" }, { "title": "是什么让你还在玩王者荣耀", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=763846&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211018/11b2611f4c4d7030d095d77940b26f27_1634561397.jpg", "play_volume": "393", "cate": "精品栏目" }, { "title": "一位“危险”但充满魅力的黑魔法师 司马懿新皮肤—暗渊魔法", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=763759&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211018/89f7fd747a0f553fb09970de80b79442_1634538427.png", "play_volume": "897", "cate": "精品栏目" }, { "title": "天暴：吸引火力老夫子，百战不折终破敌", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=762623&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211015/0693a5a495b0272b05ff1fe50cd89081_1634288216.png", "play_volume": "349", "cate": "精品栏目" }, { "title": "谁才是六元皮肤的天花板", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=762584&e_code=pvpweb_m.statictypenew.type587", "img": "https://img.tgl.qq.com/cover/20211015/43dcc3d0335f5bf6d10b6479b1372f58_1634279767.jpg", "play_volume": "1758", "cate": "精品栏目" }, { "title": "21连胜老夫子，带飞10连败钟无艳", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=762404&e_code=pvpweb_m.statictypenew.type0", "img": "https://img.tgl.qq.com/cover/20211014/54dd93140f2925d9ae789cb944e4cef0_1634202058.png", "play_volume": "1892", "cate": "精品栏目" }]

        const data2 = [{ "title": "K甲秋季赛常规赛 昆山SC vs NBW _1", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772824&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/f10ee0a7b719e94ac9afb9c0621cb32c/0/?width=230&height=140", "play_volume": "6", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 绍兴亿田SZG vs CW_4", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772806&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/b0ab6f1690b608d70de8a07485e274e9/0/?width=230&height=140", "play_volume": "16", "cate": "赛事精品" }, { "title": "【赛后采访】Star：昨天休息比较好，所以今天发挥得不错", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772802&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/abd8dcb3a47c0771b28679dd663a723e/0/?width=230&height=140", "play_volume": "20", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 绍兴亿田SZG vs CW_3", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772796&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/295856918f7fe95bd15ab34cb5f9a1b0/0/?width=230&height=140", "play_volume": "31", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 绍兴亿田SZG vs CW_2", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772793&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/8b5d9cbfdc9ac1c0c895bbb433c39a90/0/?width=230&height=140", "play_volume": "14", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 绍兴亿田SZG vs CW_1", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772792&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/43e9c601ec405f77254548b180d30300/0/?width=230&height=140", "play_volume": "10", "cate": "赛事精品" }, { "title": "【王者炸麦了】久诚激情演唱《苦涩的沙》，花海湘军野王相爱相杀", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772735&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/8ac273a90594284b6b3bbce715c9e713/0/?width=230&height=140", "play_volume": "8280", "cate": "赛事精品" }, { "title": "【赛后采访】EMC.纷杀：经历了轮换之后感觉更自信了", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772691&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/d004c02abed16b340c909995671920fd/0/?width=230&height=140", "play_volume": "86", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 EMC vs 镇江VTG_5", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772690&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/daa85c6c64c73952b9ee8dcf68fe4a8f/0/?width=230&height=140", "play_volume": "105", "cate": "赛事精品" }, { "title": "K甲秋季赛常规赛 EMC vs 镇江VTG_4", "url": "http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=772686&e_code=pvpweb_m.statictypenew.type587", "img": "http://shp.qpic.cn/cfwebcap/0/f26aaa97cd435915538b406cfea510f5/0/?width=230&height=140", "play_volume": "53", "cate": "赛事精品" }]

        const data3 = [{"title":"上分必备！你秀任你秀，猪八戒越肉！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=549556&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190829/d410e2c0849c2f8290d6589fe2849ef3.1567020053.f3bb289cad8c6c657f1ce5592ed4c1f6.230x140_13603.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"4.1万"},{"title":"王者荣耀：张大仙回归直播，秒选猪八戒机智背锅，结局却出乎意料","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=542407&e_code=pvpweb_m.statictypenew.type675","img":"http://puui.qpic.cn/qqvideo_ori/0/j0908cexchj_1280_720/0","hero":"猪八戒","cate":"英雄攻略","play_volume":"2.2万"},{"title":"张大仙无敌猪八戒以一敌三全部反杀 弹跳自由肉到飞起跪求一死","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=541373&e_code=pvpweb_m.statictypenew.type675","img":"http://puui.qpic.cn/qqvideo_ori/0/f09070tr4wp_1280_720/0","hero":"猪八戒","cate":"英雄攻略","play_volume":"103.0万"},{"title":"王者荣耀张大仙猪八戒：欢乐坦克，皮糙肉厚，活蹦乱跳","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=539039&e_code=pvpweb_m.statictypenew.type675","img":"http://puui.qpic.cn/qqvideo_ori/0/v09035dgmmn_1280_720/0","hero":"猪八戒","cate":"英雄攻略","play_volume":"5.0万"},{"title":"王者荣耀：Dnan猪八戒强势高地开团，就是要秒你不解释","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=539002&e_code=pvpweb_m.statictypenew.type675","img":"http://puui.qpic.cn/qqvideo_ori/0/m09037vs62b_1280_720/0","hero":"猪八戒","cate":"英雄攻略","play_volume":"1.9万"},{"title":"王者荣耀世冠杯：RW猪八戒侧面切入，Dnan打开高地缺口！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=541432&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190801/e9381bef41cf8b60f04b58ef2eb87a7f.1564626060.d5647524272c07dff5b729d7345aabc3.230x140_39000.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"7420"},{"title":"梦泪高端局遇神级猪八戒，遭多人围攻照样屹立不倒！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=528162&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190620/c81e728d9d4c2f636f067f89cc14862c.1561018566.16d083d656638467f661568673c37d51.230x140_64196.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"1.1万"},{"title":"王者荣耀KPL：Alan猪八戒限制敌方刺客，一个大招奠定胜局","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=525044&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190610/e9381bef41cf8b60f04b58ef2eb87a7f.1560147102.2a6870a9ee56a8bfc935a4cb28d5f957.230x140_39000.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"1.6万"},{"title":"王者荣耀KRKPL：PoPo猪八戒以逸待劳，暗中埋伏取胜利！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=525028&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190610/e9381bef41cf8b60f04b58ef2eb87a7f.1560148131.37da953d91c9f9310dbf87252a3be619.230x140_39000.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"5156"},{"title":"三招脱坑指南，教你猪八戒花式闪耙！肉丸连弹来三个也照样反杀！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=515796&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190514/a8f73a12cdddf0f835c47d97c73a52de.1557807605.ce5e681f13e507d22663fa920258f409.230x140_16021.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"9.6万"},{"title":"看到八戒来了对面怕不怕，强大的控制跟回血，八戒1V3也不怂！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=506135&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190421/9ce0bfa850c2fed133a9d728bd128f90.1555821670.4e24f9a29ff4572b1ca253dbfe4b564d.230x140_17185.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"1.1万"},{"title":"《王者荣耀》猪八戒打辅助，血厚控又足，敌人被恶心得无可奈何！","url":"http://pvp.qq.com/m/m201606/detail.shtml?G_Biz=18&tid=501728&e_code=pvpweb_m.statictypenew.type675","img":"http://itea-cdn.qq.com/file/tgl/20190404/6da9003b743b65f4c0ccd295cc484e57.1554386795.2e222acd7b166e70d2b9b5ba6bcfc68e.230x140_7489.jpg","hero":"猪八戒","cate":"英雄攻略","play_volume":"1.7万"}]

        // for (let cat of rawData) {
        //     if (cat.name === '热门') {
        //         continue
        //     }

        //     //找到当前分类在数据库中对应的数据
        //     const category = await Category.findOne({
        //         name: cat.name
        //     })
        //     //给cat里面的每个hero添加一个categories属性
        //     cat.heroes.map(hero => {
        //         hero.categories = [category]
        //     })

        //     await Hero.insertMany(cat.heroes)
        // }
        // res.send(await Hero.find())

        const data = data1.concat(data2).concat(data3)
        //对item的cate和hero重新赋值，因为数据库存的不是名字，而是id
        for (let item of data) {
            const category = await Category.findOne({
                name: item.cate
            })
            item.cate = [category]
            if (item.hero) {
                const hero = await Hero.findOne({
                    name: item.hero
                })
                item.hero = [hero]
            }
        }
        //往数据库导入strategyList
        const strategyList = data.map(item => {
            return {
                title: item.title,
                url: item.url,
                img: item.img,
                play_volume: item.play_volume,
                categories: item.cate,
                hero: item.hero
            }
        })
        await Strategy.deleteMany({})
        await Strategy.insertMany(strategyList)
        res.send(strategyList)

    })



    app.use('/web/api', router)
}
